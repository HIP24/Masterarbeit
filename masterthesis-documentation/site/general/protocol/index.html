
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="My awesome docs">
      
      
        <meta name="author" content="Halil Pamuk">
      
      
      
        <link rel="prev" href="../documentations/">
      
      
        <link rel="next" href="../timeline/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.13">
    
    
      
        <title>Protocol - Masther thesis Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dual-boot" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Masther thesis Documentation" class="md-header__button md-logo" aria-label="Masther thesis Documentation" data-md-component="logo">
      
  <img src="../../page/uni.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Masther thesis Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Protocol
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Masther thesis Documentation" class="md-nav__button md-logo" aria-label="Masther thesis Documentation" data-md-component="logo">
      
  <img src="../../page/uni.png" alt="logo">

    </a>
    Masther thesis Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thema Masterarbeit
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../master/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Master
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    QEMU
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            QEMU
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../QEMU/nmbridge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Screenshots of bridge configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    General
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            General
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../checklist/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Checklist
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Components
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../documentations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Protocol
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Protocol
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dual-boot" class="md-nav__link">
    <span class="md-ellipsis">
      Dual Boot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-salamander4-os" class="md-nav__link">
    <span class="md-ellipsis">
      Install Salamander4 OS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-ip-addresses" class="md-nav__link">
    <span class="md-ellipsis">
      Configure ip addresses
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-to-device" class="md-nav__link">
    <span class="md-ellipsis">
      SSH to device
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lasalclass2-to-device" class="md-nav__link">
    <span class="md-ellipsis">
      LasalClass2 to device
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-bridge-for-qemu" class="md-nav__link">
    <span class="md-ellipsis">
      Configure bridge for qemu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-the-xenomai-test-suite" class="md-nav__link">
    <span class="md-ellipsis">
      Use the Xenomai test suite
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#isolate-cpus-on-host-system-ubuntu" class="md-nav__link">
    <span class="md-ellipsis">
      Isolate CPUs on host system (Ubuntu)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trace-cmd-problems" class="md-nav__link">
    <span class="md-ellipsis">
      trace-cmd Problems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="trace-cmd Problems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2-problems" class="md-nav__link">
    <span class="md-ellipsis">
      2 Problems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-i-did" class="md-nav__link">
    <span class="md-ellipsis">
      What I did
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution-to-trace-cmd-problems" class="md-nav__link">
    <span class="md-ellipsis">
      Solution to trace-cmd Problems
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ubuntu-vm-on-virtual-machine-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Ubuntu VM on virtual machine manager
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../timeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timeline
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Sigmatek
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Sigmatek
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sigmatek/bash_commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bash commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sigmatek/build_LRT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build LRT - Salamander 3 Terminal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sigmatek/build_with_yocto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build with Yocto
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Trace cmd
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Trace cmd
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    LTS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            LTS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1_1" id="__nav_6_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Kernel shark kernelshark v2.1.0
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_1">
            <span class="md-nav__icon md-icon"></span>
            Kernel shark kernelshark v2.1.0
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trace-cmd/LTS/kernel-shark-kernelshark-v2.1.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_2" >
        
          
          <label class="md-nav__link" for="__nav_6_1_2" id="__nav_6_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Libtraceevent 1.8.2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_2">
            <span class="md-nav__icon md-icon"></span>
            Libtraceevent 1.8.2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trace-cmd/LTS/libtraceevent-1.8.2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_3" >
        
          
          <label class="md-nav__link" for="__nav_6_1_3" id="__nav_6_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Libtracefs 1.8.0
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_3">
            <span class="md-nav__icon md-icon"></span>
            Libtracefs 1.8.0
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trace-cmd/LTS/libtracefs-1.8.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_4" >
        
          
          <label class="md-nav__link" for="__nav_6_1_4" id="__nav_6_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Trace cmd libtracecmd 1.5.1
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_4">
            <span class="md-nav__icon md-icon"></span>
            Trace cmd libtracecmd 1.5.1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trace-cmd/LTS/trace-cmd-libtracecmd-1.5.1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_5" >
        
          
          <label class="md-nav__link" for="__nav_6_1_5" id="__nav_6_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Trace cmd v3.2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_5">
            <span class="md-nav__icon md-icon"></span>
            Trace cmd v3.2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trace-cmd/LTS/trace-cmd-v3.2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trace-cmd/analysis/info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Info
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trace-cmd/analysis/kernelshark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kernelshark
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Workflow
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Workflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/most_popular_paths/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Most popular paths
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/useful/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Useful
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/useful_links/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Useful links
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/useful_notneeded/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Useful notneeded
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Xenomai
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Xenomai
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xenomai/clocktest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    clocktest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xenomai/latency/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    latency
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xenomai/switchtest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    switchtest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xenomai/xenomai-system-tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xenomai system tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Yocto
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Yocto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../yocto/after_bitbake/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    After bitbake
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../yocto/fix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fix
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dual-boot" class="md-nav__link">
    <span class="md-ellipsis">
      Dual Boot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-salamander4-os" class="md-nav__link">
    <span class="md-ellipsis">
      Install Salamander4 OS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-ip-addresses" class="md-nav__link">
    <span class="md-ellipsis">
      Configure ip addresses
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-to-device" class="md-nav__link">
    <span class="md-ellipsis">
      SSH to device
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lasalclass2-to-device" class="md-nav__link">
    <span class="md-ellipsis">
      LasalClass2 to device
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-bridge-for-qemu" class="md-nav__link">
    <span class="md-ellipsis">
      Configure bridge for qemu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-the-xenomai-test-suite" class="md-nav__link">
    <span class="md-ellipsis">
      Use the Xenomai test suite
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#isolate-cpus-on-host-system-ubuntu" class="md-nav__link">
    <span class="md-ellipsis">
      Isolate CPUs on host system (Ubuntu)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trace-cmd-problems" class="md-nav__link">
    <span class="md-ellipsis">
      trace-cmd Problems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="trace-cmd Problems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2-problems" class="md-nav__link">
    <span class="md-ellipsis">
      2 Problems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-i-did" class="md-nav__link">
    <span class="md-ellipsis">
      What I did
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution-to-trace-cmd-problems" class="md-nav__link">
    <span class="md-ellipsis">
      Solution to trace-cmd Problems
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ubuntu-vm-on-virtual-machine-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Ubuntu VM on virtual machine manager
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Protocol</h1>

<h2 id="dual-boot">Dual Boot</h2>
<p>1) Flash SSD by installing <a href="https://etcher.balena.io/" target="_blank">etcher</a>
2) Ubuntu and Windows on same machine</p>
<h2 id="install-salamander4-os">Install Salamander4 OS</h2>
<p>1) Install Ubuntu 22.04.3 LTS
2) Do everything in <a href="../../sigmatek/build_with_yocto/">build_with_yocto.md</a></p>
<h2 id="configure-ip-addresses">Configure ip addresses</h2>
<p><a href="../../resources/images/configure_ip/ip_static_connection_ubuntu.png">Configure PC</a> to <code>10.10.1.1</code>. <br />
<a href="../../resources/images/configure_ip/ip_list_ubuntu.png">Salamander Gateway</a> set to <code>10.10.1.229</code></p>
<h2 id="ssh-to-device">SSH to device</h2>
<p>Connect to device with <code>ssh -oHostKeyAlgorithms=+ssh-rsa root@10.10.1.229</code><br />
or <code>ssh -p 22 root@192.168.1.x</code> (changes often)</p>
<h2 id="lasalclass2-to-device">LasalClass2 to device</h2>
<p>Connect LasalClass2 with <a href="../../resources/images/lasal/class2/lasalclass2_ip.png">Salamander 4</a>, IP of <a href="../../resources/images/lasal/class2/lasalclass2_salamander4_ip.png">Salamander4 device</a></p>
<h2 id="configure-bridge-for-qemu">Configure bridge for qemu</h2>
<p>This setup allows the virtual machines to communicate with the outside network through the Ethernet connection provided by either the laptop or the docking station.</p>
<table>
<thead>
<tr>
<th>name</th>
<th>device</th>
</tr>
</thead>
<tbody>
<tr>
<td>enp0s31f6</td>
<td>Laptop's Ethernet port</td>
</tr>
<tr>
<td>enx4cd717733f80</td>
<td>Docking station's Ethernet port</td>
</tr>
</tbody>
</table>
<ul>
<li>Disable <a href="../../resources/images/configure_bridge/ethernet_disable_ip4.png">ipv4</a> and <a href="../../resources/images/configure_bridge/ethernet_disable_ip6.png">ipv6</a></li>
<li>Enter <a href="../../resources/images/configure_bridge/nmtui.png">nmtui</a></li>
<li>Edit Connection and <a href="../../resources/images/configure_bridge/add_connection.png">\&lt;Add&gt;</a>. Select Bridge.</li>
<li><a href="../../resources/images/configure_bridge/edit_connection.png">Edit</a> and \&lt;Add&gt; Ethernet.</li>
<li><a href="../../resources/images/configure_bridge/copy_name.png">Copy name</a> enx4cd717733f80 (4C:D7:17:73:3F:80) of Wired connection 2</li>
<li><a href="../../resources/images/configure_bridge/ethernet1.png">Edit Connection of Ethernet connection 1</a> so that it automatically connects.</li>
<li><a href="../../resources/images/configure_bridge/activate_connection.png">Activate Connection</a>.</li>
<li>Result should look like <a href="../../resources/images/configure_bridge/get-to-know/connections.png">this</a> and <a href="../../resources/images/configure_bridge/get-to-know/bridge_connections.png">this</a>.</li>
<li>More info in <a href="../../QEMU/nmbridge/">nmbridge.md</a>. </li>
</ul>
<h2 id="use-the-xenomai-test-suite">Use the Xenomai test suite</h2>
<ul>
<li><code>latency -T 60</code>  </li>
<li><code>clocktest -D -T 60</code> </li>
</ul>
<h2 id="isolate-cpus-on-host-system-ubuntu">Isolate CPUs on host system (Ubuntu)</h2>
<p>To isolate CPUs on your host system (Ubuntu), you can add the <code>isolcpus</code> option to the kernel boot configuration. Here are the steps you can follow:</p>
<ol>
<li>Open the GRUB configuration file with a text editor. You can use the <code>nano</code> editor for this. Execute the following command in your terminal:
    <code>bash
    sudo nano /etc/default/grub</code></li>
<li>Search for the entry <code>GRUB_CMDLINE_LINUX</code> and add <code>isolcpus=0,1,2,3,4</code> (or the corresponding CPU numbers you want to isolate). It should then look like this:
    <code>bash
    GRUB_CMDLINE_LINUX="isolcpus=0,1,2,3,4"</code></li>
<li>
<p>Save the changes and close the editor. If you are using <code>nano</code>, you can do this by pressing <code>Ctrl+X</code>, then typing <code>Y</code> to save the changes, and finally pressing <code>Enter</code> to close the editor.</p>
</li>
<li>
<p>Update GRUB with the following command:
    <code>bash
    sudo update-grub</code></p>
</li>
<li>Reboot your system for the changes to take effect.</li>
</ol>
<p>Check with: <code>cat /sys/devices/system/cpu/isolated</code></p>
<pre><code>sigma_ibo@pamhal:~$ cat /sys/devices/system/cpu/online 
0-19
sigma_ibo@pamhal:~$ cat /sys/devices/system/cpu/isolated
0-4
</code></pre>
<p>Before taskset with <a href="../../QEMU/qemu_def_4schedstats.sh"><code>qemu_def_4schedstats.sh</code></a></p>
<pre><code>sigma_ibo@pamhal:$ ps -eo pid,psr,comm | grep qemu
   7295  10 start_qemu.sh
   7298  17 qemu-system-x86
</code></pre>
<p><code>latency -s -T 60</code></p>
<pre><code>root@sigmatek-core2:~# latency -s -T 60
== Sampling period: 100 us
== Test mode: periodic user-mode task
== All results in microseconds
warming up...
RTT|  00:00:01  (periodic user-mode task, 100 us period, priority 99)
RTH|----lat min|----lat avg|----lat max|-overrun|---msw|---lat best|--lat worst
RTD|      1.393|      2.908|     21.765|       0|     0|      1.393|     21.765
RTD|      1.740|      2.933|     12.989|       0|     0|      1.393|     21.765
RTD|      1.603|      2.954|     22.063|       0|     0|      1.393|     22.063
RTD|      1.361|      2.988|     22.156|       0|     0|      1.361|     22.156
RTD|      1.839|      3.059|    119.253|       2|     0|      1.361|    119.253
RTD|      1.665|      2.955|     47.442|       2|     0|      1.361|    119.253
RTD|      1.603|      2.869|     12.336|       2|     0|      1.361|    119.253
RTD|      1.649|      2.953|     17.917|       2|     0|      1.361|    119.253
RTD|      1.359|      2.990|     15.286|       2|     0|      1.359|    119.253
RTD|      1.584|      2.959|     15.387|       2|     0|      1.359|    119.253
RTD|      1.910|      2.997|     84.273|       2|     0|      1.359|    119.253
RTD|      1.799|      4.133|    112.034|       3|     0|      1.359|    119.253
RTD|      2.388|      4.397|     27.953|       3|     0|      1.359|    119.253
RTD|      1.263|      3.331|    374.075|      12|     0|      1.263|    374.075
RTD|      1.842|      2.900|    154.898|      14|     0|      1.263|    374.075
RTD|      2.170|      2.876|     14.770|      14|     0|      1.263|    374.075
RTD|      1.742|      2.952|     23.002|      14|     0|      1.263|    374.075
RTD|      2.149|      2.903|    207.981|      17|     0|      1.263|    374.075
RTD|      1.275|      2.884|    234.734|      21|     0|      1.263|    374.075
RTD|      1.456|      3.018|    190.368|      25|     0|      1.263|    374.075
RTD|      1.301|      2.855|    255.438|      27|     0|      1.263|    374.075
RTT|  00:00:22  (periodic user-mode task, 100 us period, priority 99)
RTH|----lat min|----lat avg|----lat max|-overrun|---msw|---lat best|--lat worst
RTD|      1.442|      2.847|     16.121|      27|     0|      1.263|    374.075
RTD|      1.609|      2.886|     54.156|      27|     0|      1.263|    374.075
RTD|      1.193|      2.838|     13.409|      27|     0|      1.193|    374.075
RTD|      1.175|      2.835|      9.749|      27|     0|      1.175|    374.075
RTD|      2.120|      2.833|      9.886|      27|     0|      1.175|    374.075
RTD|      1.205|      2.830|      9.281|      27|     0|      1.175|    374.075
RTD|      1.288|      2.836|     15.243|      27|     0|      1.175|    374.075
RTD|      1.358|      2.865|     24.674|      27|     0|      1.175|    374.075
RTD|      1.369|      2.852|     95.134|      27|     0|      1.175|    374.075
RTD|      1.198|      2.853|    122.350|      28|     0|      1.175|    374.075
RTD|      1.883|      2.861|    119.295|      29|     0|      1.175|    374.075
RTD|      1.479|      2.840|     16.134|      29|     0|      1.175|    374.075
RTD|      1.389|      2.853|     13.289|      29|     0|      1.175|    374.075
RTD|      1.779|      2.887|     22.949|      29|     0|      1.175|    374.075
RTD|      1.592|      2.847|     82.516|    with
RTD|      2.293|      2.843|     40.522|      29|     0|      1.175|    374.075
RTD|      1.207|      2.888|    138.783|      30|     0|      1.175|    374.075
RTD|      1.405|      2.862|     21.464|      30|     0|      1.175|    374.075
RTD|      1.218|      2.853|     13.491|      30|     0|      1.175|    374.075
RTT|  00:00:43  (periodic user-mode task, 100 us period, priority 99)
RTH|----lat min|----lat avg|----lat max|-overrun|---msw|---lat best|--lat worst
RTD|      1.269|      2.865|      9.891|      30|     0|      1.175|    374.075
RTD|      1.343|      2.866|     52.299|      30|     0|      1.175|    374.075
RTD|      1.303|      2.868|     27.312|      30|     0|      1.175|    374.075
RTD|      1.544|      2.904|     30.962|      30|     0|      1.175|    374.075
RTD|      1.310|      2.939|    193.024|      31|     0|      1.175|    374.075
RTD|      1.416|      2.917|    206.245|      34|     0|      1.175|    374.075
RTD|      1.384|      2.871|     10.043|      34|     0|      1.175|    374.075
RTD|      1.462|      2.863|    150.257|      35|     0|      1.175|    374.075
RTD|      1.570|      2.917|    152.735|      37|     0|&gt; lat worst reduced from 374.075 to 87.379
      1.175|    374.075
RTD|      1.626|      2.983|    149.424|      40|     0|      1.175|    374.075
RTD|      1.247|      2.999|     24.876|      40|     0|      1.175|    374.075
RTD|      1.637|      2.999|     13.527|      40|     0|      1.175|    374.075
HSH|--param|--samples-|--average--|---stddev--
HSS|    min|        59|      1.085|      0.281
HSS|    avg|    599943|      2.200|      1.460
HSS|    max|        59|     68.847|     77.257
---|-----------|-----------|-----------|--------|------|-------------------------
RTS|      1.175|      2.955|    374.075|      40|     0|    00:01:00/00:01:00
</code></pre>
<p>After taskset on CPU4 with <a href="../../QEMU/qemu_def_5taskset.sh"><code>qemu_def_5taskset.sh</code></a></p>
<pre><code>sigma_ibo@pamhal:$ ps -eo pid,psr,comm | grep qemu
   8752   0 start_qemu.sh
   8755   4 qemu-system-x86
</code></pre>
<pre><code>root@sigmatek-core2:~# latency -s -T 60
== Sampling period: 100 us
== Test mode: periodic user-mode task
== All results in microseconds
warming up...
RTT|  00:00:01  (periodic user-mode task, 100 us period, priority 99)
RTH|----lat min|----lat avg|----lat max|-overrun|---msw|---lat best|--lat worst
RTD|      1.518|      2.994|     60.423|       0|     0|      1.518|     60.423
RTD|      1.245|      2.787|     50.589|       0|     0|      1.245|     60.423
RTD|      1.925|      2.845|     82.861|       0|     0|      1.245|     82.861
RTD|      1.237|      2.963|     83.906|       0|     0|      1.237|     83.906
RTD|      1.167|      2.777|     19.388|       0|     0|      1.167|     83.906
RTD|      1.333|      2.779|     33.484|       0|     0|      1.167|     83.906
RTD|      1.330|      2.921|     31.062|       0|     0|      1.167|     83.906
RTD|      1.567|      2.777|     15.960|       0|     0|      1.167|     83.906
RTD|      1.900|      2.902|     17.630|       0|     0|      1.167|     83.906
RTD|      1.230|      3.012|     55.056|       0|     0|      1.167|     83.906
RTD|      1.480|      2.822|     50.378|       0|     0|      1.167|     83.906
RTD|      1.197|      2.770|     16.093|       0|     0|      1.167|     83.906
RTD|      1.525|      2.879|     79.003|       0|     0|      1.167|     83.906
RTD|      1.417|      2.788|     39.852|       0|     0|      1.167|     83.906
RTD|      1.468|      3.857|     60.830|       0|     0|      1.167|     83.906
RTD|      2.305|      4.212|     55.658|       0|     0|      1.167|     83.906
RTD|      1.882|      4.158|     43.550|       0|     0|      1.167|     83.906
RTD|      2.059|      4.144|     49.666|       0|     0|      1.167|     83.906
RTD|      2.439|      4.157|     87.379|       0|     0|      1.167|     87.379
RTD|      2.067|      4.178|     73.607|       0|     0|      1.167|     87.379
RTD|      1.772|      3.334|     54.281|       0|     0|      1.167|     87.379
RTT|  00:00:22  (periodic user-mode task, 100 us period, priority 99)
RTH|----lat min|----lat avg|----lat max|-overrun|---msw|---lat best|--lat worst
RTD|      1.605|      2.794|     57.324|       0|     0|      1.167|     87.379
RTD|      1.196|      2.763|      7.132|       0|     0|      1.167|     87.379
RTD|      2.285|      3.849|     51.351|       0|     0|      1.167|     87.379
RTD|      2.001|      4.221|     56.
502|       0|     0|      1.167|     87.379
RTD|      1.507|      2.787|     30.784|       0|     0|      1.167|     87.379
RTD|      1.277|      2.782|     28.294|       0|     0|      1.167|     87.379
RTD|      2.193|      2.797|     28.698|       0|     0|      1.167|     87.379
RTD|      1.899|      2.772|     23.894|       0|     0|      1.167|     87.379
RTD|      1.325|      2.831|     22.687|       0|     0|      1.167|     87.379
RTD|      1.195|      2.928|     36.321|       0|     0|      1.167|     87.379
RTD|      1.644|      2.812|     31.942|       0|     0|      1.167|     87.379
RTD|      1.544|      2.780|     33.094|       0|     0|      1.167|     87.379
RTD|      1.650|      2.889|     18.863|       0|     0|      1.167|     87.379
RTD|      1.271|      2.792|     38.819|       0|     0|      1.167|     87.379
RTD|      1.902|      2.981|     59.703|       0|     0|      1.167|     87.379
RTD|      1.802|      3.091|     56.189|       0|     0|      1.167|     87.379
RTD|      1.304|      2.818|     38.355|       0|     0|      1.167|     87.379
RTD|      1.571|      2.827|     52.074|       0|     0|      1.167|     87.379
RTT|  00:00:43  (periodic user-mode task, 100 us period, priority 99)
RTH|----lat min|----lat avg|----lat max|-overrun|---msw|---lat best|--lat worst
RTD|      1.465|      2.949|     49.229|       0|     0|      1.167|     87.379
RTD|      1.765|      2.800|     42.433|       0|     0|      1.167|     87.379
RTD|      1.220|      2.967|     45.561|       0|     0|      1.167|     87.379
RTD|      1.874|      3.020|     74.500|       0|     0|      1.167|     87.379
RTD|      1.304|      2.881|     43.092|       0|     0|      1.167|     87.379
RTD|      1.231|      2.836|     10.778|       0|     0|      1.167|     87.379
RTD|      1.901|      2.944|     59.756|       0|     0|      1.167|     87.379
RTD|      1.316|      2.820|     32.074|       0|     0|      1.167|     87.379
RTD|      1.235|      2.896|     55.582|       0|     0|      1.167|     87.379
RTD|      1.171|      2.824|     68.296|       0|     0|      1.167|     87.379
RTD|      1.384|      2.832|     49.778|       0|     0|      1.167|     87.379
RTD|      1.935|      2.770|     47.123|       0|     0|      1.167|     87.379
RTD|      1.154|      2.821|     41.895|       0|     0|      1.154|     87.379
RTD|      1.315|      2.803|     36.721|       0|     0|      1.154|     87.379
RTD|      1.881|      2.983|     76.927|       0|     0|      1.154|     87.379
RTD|      1.619|      2.999|     68.384|       0|     0|      1.154|     87.379
RTD|      1.388|      2.797|     58.660|       0|     0|      1.154|     87.379
HSH|--param|--samples-|--average--|---stddev--
HSS|    min|        59|      1.119|      0.326
HSS|    avg|    599984|      2.428|      1.112
HSS|    max|        59|     46.746|     19.462
---|-----------|-----------|-----------|--------|------|-------------------------
RTS|      1.154|      3.078|     87.379|       0|     0|    00:01:00/00:01:00
</code></pre>
<blockquote>
<p>lat worst reduced from 374.075 to 87.379</p>
</blockquote>
<h2 id="trace-cmd-problems">trace-cmd Problems</h2>
<p><a href="https://rostedt.org/host-guest-tutorial/" target="_blank">Rostedt Tutorial</a><br />
<code>sudo trace-cmd record -e kvm:kvm_entry -e kvm:kvm_exit -A @3:823 --name Salamander4 -e all</code></p>
<h3 id="2-problems">2 Problems</h3>
<ol>
<li>
<p>"Failed to negotiate timestamps synchronization with the host"
<a href="../../resources/images/trace-cmd/timestamp_error.png">timestamp_error.png</a></p>
</li>
<li>
<p>"Cannot find host / guest tracing into the loaded streams" <a href="../../resources/images/trace-cmd/kvm_combo_error.png">kvm_combo_error.png</a></p>
</li>
</ol>
<p>(These were solved in <a href="#ubuntu-vm-on-virtual-machine-manager">Ubuntu 22.04 VM</a>)</p>
<h3 id="what-i-did">What I did</h3>
<ol>
<li>
<ul>
<li>enabled
        - CONFIG_VSOCKETS=y
        - CONFIG_VHOST_VSOCK=y
        - CONFIG_VIRTIO_VSOCKETS=y
        - CONFIG_VIRTIO_VSOCKETS_COMMON=y
        - CONFIG_VSOCKETS_DIAG=y
        - CONFIG_VSOCKETS_LOOPBACK=y
        - CONFIG_TRACING=y<br />
        - CONFIG_FTRACE=y<br />
        - CONFIG_FUNCTION_TRACER=y<br />
        - CONFIG_FUNCTION_GRAPH_TRACER=y<br />
        - CONFIG_DYNAMIC_FTRACE=y<br />
        - CONFIG_DYNAMIC_FTRACE_WITH_REGS=y<br />
        - CONFIG_DYNAMIC_FTRACE_WITH_DIRECT_CALLS=y<br />
        - CONFIG_DYNAMIC_FTRACE_WITH_ARGS=y<br />
        - CONFIG_SCHED_TRACER=y<br />
        - CONFIG_FTRACE_SYSCALLS=y<br />
        - CONFIG_TRACER_SNAPSHOT=y<br />
        - CONFIG_KPROBE_EVENTS=y<br />
        - CONFIG_UPROBE_EVENTS=y<br />
        - CONFIG_BPF_EVENTS=y<br />
        - CONFIG_DYNAMIC_EVENTS=y<br />
        - CONFIG_PROBE_EVENTS=y<br />
        - CONFIG_SYNTH_EVENTS=y<br />
        - CONFIG_HIST_TRIGGERS=y  </li>
</ul>
</li>
<li>checked via zcat /proc/config.gz if everything landed on the kernel</li>
<li>changed clocksource in guest from kvm-clock to tsc in <code>/sys/devices/system/clocksource/clocksource0</code>  </li>
<li>Did not check Code yet </li>
<li>Nothing yet, probably hand in hand with 1.</li>
</ol>
<h2 id="solution-to-trace-cmd-problems">Solution to <a href="#trace-cmd-problems">trace-cmd Problems</a></h2>
<p>The problem was the trace-cmd version. Set both host and guest to v3.2.0 by copying the files from host to guest:</p>
<pre><code>scp /usr/local/bin/trace-cmd root@&quot;$ip_address&quot;:/usr/bin
scp /usr/local/lib64/libtracefs.so.1 root@&quot;$ip_address&quot;:/lib64
scp /usr/local/lib64/libtraceevent.so.1 root@&quot;$ip_address&quot;:/lib64
</code></pre>
<p>Now, <a href="../../resources/images/trace-cmd/trace-cmd_version3.2.0.png">trace-cmd version 3.2.0</a> is active and <a href="../../resources/images/trace-cmd/time_sync.png">tracing the guest</a> finally works with <code>trace-cmd agent</code> on the guest.</p>
<p>Using kernelshark with <code>kernelshark trace.dat -a trace-Salamander4.dat</code> or simply <a href="../../trace-cmd/analysis/test/start_kernelshark.sh"><code>./start_kernelshark.sh</code></a>, we get the expected <a href="../../resources/images/trace-cmd/kernelshark/kernelshark_combo.png">visualization</a>. Events of the guest happen between kvm_entry and kvm_exit of the host.</p>
<h2 id="ubuntu-vm-on-virtual-machine-manager">Ubuntu VM on virtual machine manager</h2>
<p>After giving the VM <a href="../../resources/images/protocol/virtm_cid.png">access to the vsocket</a>, and installing trace-cmd along with <a href="../../trace-cmd/LTS/trace-cmd-v3.2/">dependancies</a>, run <a href="../../resources/images/protocol/trace-cmd_agent.png"><code>trace-cmd agent</code></a>. Now, the guest is able to negotiate with host about <a href="../../resources/images/protocol/negotiated_with_guest.png">timestamp synchronization</a>. After running <a href="../../trace-cmd/analysis/test/start_kernelshark.sh"><code>./start_kernelshark.sh</code></a>, we can view <a href="../../resources/images/protocol/kvm_combo_plots.png">KVM Combo plots</a></p>
<div style="text-align: right">

[Link to top](#)

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8d2eff1.min.js"></script>
      
    
  </body>
</html>