
## Kernel Configurations
```

```

## QEMU Configurations

### Tune lapic timer advance
   You can set the value of the lapic timer advance to 7500 with this command:
   ```
   echo 7500 | sudo tee /sys/module/kvm/parameters/lapic_timer_advance_ns
   ```
   This value might be different for different chips.

### Set QEMU options for real-time VM
   You can set several options when starting your QEMU virtual machine to improve real-time performance. Here are some examples:
   - `-realtime mlock=on`: This option locks the memory of the VM to avoid swapping and lazy allocation.
   - `-balloon none`: This option disables the balloon driver, which can free and return memory to the host OS.
   - `-mem-prealloc -mem-path /dev/hugepages/`: These options enable the use of hugepages, which can reduce TLB misses and improve performance.

### Set CPU affinity and scheduling policy of QEMU CPU threads
   You can set the CPU affinity of the QEMU CPU threads to specific CPUs (in this case, CPUs 2 and 3) and set the scheduling policy to FIFO with the highest priority. You'll need to find the PIDs of the QEMU CPU threads first. Once you have the PIDs, you can use the `taskset` and `chrt` commands to set the CPU affinity and scheduling policy. Replace `<pid>` with the PID of the thread:
   ```
   sudo taskset -a -p -c 2,3 <pid>
   sudo chrt -f -p 99 <pid>
   ```

### Passthrough PCI devices into the VM
   If you need to passthrough PCI devices into the VM, you can do so using the `-device vfio-pci,host=xx:xx.x` option when starting your QEMU virtual machine. Replace `xx:xx.x` with the PCI address of the device you want to passthrough.

## Trace latency 
```
latency -h -s -T 600 -g max_latency_rt.txt
```